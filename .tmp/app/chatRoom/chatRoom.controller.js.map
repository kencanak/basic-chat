{"version":3,"sources":["../../../client/app/chatRoom/chatRoom.controller.js"],"names":[],"mappings":"AAAA;;;;;;AAEA,CAAC,YAAW;AAAA,MAEN,kBAFM;AAGV,gCAAY,IAAZ,EAAkB,MAAlB,EAA0B,IAA1B,EAAgC,MAAhC,EAAwC;AAAA;;AACtC,WAAK,IAAL,GAAY,IAAZ;AACA,WAAK,UAAL,GAAkB,KAAK,UAAvB;AACA,WAAK,cAAL,GAAsB,KAAK,cAA3B;AACA,WAAK,UAAL,GAAkB,KAAK,cAAL,GAAsB,MAAxC;AACA,WAAK,IAAL,GAAY,IAAZ;AACA,WAAK,IAAL,GAAY,EAAZ;AACA,WAAK,MAAL,GAAc,IAAd;AACA,WAAK,MAAL,GAAc,OAAO,MAArB;AACA,WAAK,mBAAL,GAA2B,KAAK,cAAL,GAAsB,QAAjD;AACA,WAAK,UAAL,GAAkB,KAAlB;AACA,UAAI,OAAO,IAAX;;AAEA,QAAE,SAAF,EAAa,IAAb;AACA,QAAE,kBAAF,EAAsB,OAAtB,CAA8B,EAAC,cAAc,IAAf,EAA9B;AACA,QAAE,gBAAF,EAAoB,SAApB,CAA8B;AAC5B,qBAAa;AADe,OAA9B;;;AAKA,WAAK,MAAL,CAAY,EAAZ,CAAe,aAAf,EAA8B,UAAS,KAAT,EAAe;AAC3C,aAAK,UAAL,GAAkB,MAAM,MAAN,KAAiB,KAAK,cAAL,GAAsB,QAAzD;AACD,OAFD;;AAIA,WAAK,MAAL,CAAY,EAAZ,CAAe,aAAf,EAA8B,UAAS,IAAT,EAAc;AAC1C,YAAI,KAAK,mBAAL,IAA4B,KAAK,mBAAL,CAAyB,OAAzB,CAAiC,IAAjC,IAAyC,CAAC,CAA1E,EACA;AACE,cAAI,gBAAgB,EAAE,WAAS,IAAT,GAAc,mBAAhB,CAApB;AACA,sBAAY,KAAZ,CAAkB,aAAlB,EAAiC,IAAjC;AACD;AACF,OAND;;AAQA,WAAK,MAAL,CAAY,EAAZ,CAAe,iBAAf,EAAkC,YAAU;AACxC,aAAK,sBAAL;AACH,OAFD;AAGD;;AAtCS;AAAA;AAAA,+CAuCc;AAAA;;AACtB,aAAK,IAAL,CAAU,GAAV,GAAgB,QAAhB,CAAyB,IAAzB,CAA8B,oBAAY;AACxC,kBAAQ,GAAR,CAAY,SAAS,QAArB;AACA,gBAAK,mBAAL,GAA2B,SAAS,QAApC;AACD,SAHD;AAID;AA5CS;AAAA;AAAA,qCA8CK,IA9CL,EA8CW;AAAA;;AACnB,aAAK,MAAL,GAAc,EAAd;AACA,YAAI,KAAK,MAAT,EAAiB;AACf,eAAK,IAAL,CAAU,cAAV,CAAyB,KAAK,IAAL,CAAU,WAAnC,EAAgD,KAAK,IAAL,CAAU,WAA1D,EACG,IADH,CACQ,YAAM;AACV,cAAE,sBAAF,EAA0B,UAA1B;AACA,gBAAI,gBAAgB,EAAE,4CAAF,CAApB;AACA,wBAAY,KAAZ,CAAkB,aAAlB,EAAiC,IAAjC;AACD,WALH,EAMG,KANH,CAMS,YAAM;AACX,mBAAK,MAAL,GAAc,oBAAd;AACD,WARH;AASD;AACF;AA3DS;AAAA;AAAA,qCA8DI;AACZ,aAAK,IAAL,CAAU,YAAV,CAAuB;AACrB,cAAI,KAAK,cAAL,GAAsB,GADL,EACU,QAAQ,KAAK,UAAL,CAAgB,IAAhB,EADlB,EAAvB,EACkE,QADlE,CAC2E,IAD3E,CACgF,oBAAY;AACxF,cAAI,gBAAgB,EAAE,0CAAF,CAApB;AACA,sBAAY,KAAZ,CAAkB,aAAlB,EAAiC,IAAjC;AACH,SAJD;AAMD;AArES;;AAAA;AAAA;;AAwEZ,UAAQ,MAAR,CAAe,SAAf,EACG,UADH,CACc,oBADd,EACoC,kBADpC;AAGC,CA3ED","file":"chatRoom.controller.js","sourcesContent":["'use strict';\n\n(function() {\n\nclass ChatRoomController {\n  constructor(Auth, $scope, User, socket) {\n    this.Auth = Auth;\n    this.isLoggedIn = Auth.isLoggedIn;\n    this.getCurrentUser = Auth.getCurrentUser;\n    this.userStatus = this.getCurrentUser().status;\n    this.User = User;\n    this.user = {};\n    this.errors = null;\n    this.socket = socket.socket;\n    this.currentUserContacts = this.getCurrentUser().contacts;\n    this.newMessage = false;\n    var that = this;\n\n    $('ul.tabs').tabs();\n    $(\".button-collapse\").sideNav({closeOnClick: true});\n    $('.modal-trigger').leanModal({\n      dismissible: false\n    });\n\n    //check for socket send message broadcast\n    this.socket.on('New Message', function(param){\n      that.newMessage = param.author !== that.getCurrentUser().userName;\n    });\n\n    this.socket.on('User Online', function(user){\n      if (that.currentUserContacts && that.currentUserContacts.indexOf(user) > -1)\n      {\n        var $toastContent = $('<span>'+user+' is online</span>');\n        Materialize.toast($toastContent, 5000);\n      }\n    });\n\n    this.socket.on('Update Contacts', function(){\n        that.grabLatestContactsList();\n    });\n  }\n  grabLatestContactsList(){\n    this.User.get().$promise.then(response => {\n      console.log(response.contacts);\n      this.currentUserContacts = response.contacts;\n    });\n  }\n\n  changePassword(form) {\n    this.errors = '';\n    if (form.$valid) {\n      this.Auth.changePassword(this.user.oldPassword, this.user.newPassword)\n        .then(() => {\n          $(\"#changePasswordModal\").closeModal();\n          var $toastContent = $('<span>Password changed successfully</span>');\n          Materialize.toast($toastContent, 5000);\n        })\n        .catch(() => {\n          this.errors = 'Incorrect password';\n        });\n    }\n  }\n\n\n  updateStatus(){\n    this.User.updateStatus({\n      id: this.getCurrentUser()._id, status: this.userStatus.trim()}).$promise.then(response => {\n        var $toastContent = $('<span>Status updated successfully</span>');\n        Materialize.toast($toastContent, 5000);\n    });\n\n  }\n}\n\nangular.module('chatApp')\n  .controller('ChatRoomController', ChatRoomController);\n\n})();\n"]}