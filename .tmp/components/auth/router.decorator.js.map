{"version":3,"sources":["../../../client/components/auth/router.decorator.js"],"names":[],"mappings":"AAAA;;AAEA,CAAC,YAAW;;AAEZ,UAAQ,MAAR,CAAe,cAAf,EACG,GADH,CACO,UAAS,UAAT,EAAqB,MAArB,EAA6B,IAA7B,EAAmC;;AAEtC,eAAW,GAAX,CAAe,mBAAf,EAAoC,UAAS,KAAT,EAAgB,IAAhB,EAAsB;AACxD,UAAI,CAAC,KAAK,YAAV,EAAwB;AACtB;AACD;;AAED,UAAI,OAAO,KAAK,YAAZ,KAA6B,QAAjC,EAA2C;AACzC,aAAK,OAAL,CAAa,KAAK,YAAlB,EAAgC,EAAE,IAAlC,EAAwC,IAAxC,CAA6C,eAAO;AAClD,cAAI,GAAJ,EAAS;AACP;AACD;;AAED,gBAAM,cAAN;AACA,iBAAO,KAAK,UAAL,CAAgB,EAAE,IAAlB,EAAwB,IAAxB,CAA6B,cAAM;AACxC,mBAAO,EAAP,CAAU,KAAK,UAAL,GAAkB,MAA5B;AACD,WAFM,CAAP;AAGD,SATD;AAUD,OAXD,MAWO;AACL,aAAK,UAAL,CAAgB,EAAE,IAAlB,EAAwB,IAAxB,CAA6B,cAAM;AACjC,cAAI,EAAJ,EAAQ;AACN;AACD;;AAED,gBAAM,cAAN;AACA,iBAAO,EAAP,CAAU,MAAV;AACD,SAPD;AAQD;AACF,KA1BD;AA2BD,GA9BH;AAgCC,CAlCD","file":"router.decorator.js","sourcesContent":["'use strict';\n\n(function() {\n\nangular.module('chatApp.auth')\n  .run(function($rootScope, $state, Auth) {\n    // Redirect to login if route requires auth and the user is not logged in, or doesn't have required role\n    $rootScope.$on('$stateChangeStart', function(event, next) {\n      if (!next.authenticate) {\n        return;\n      }\n\n      if (typeof next.authenticate === 'string') {\n        Auth.hasRole(next.authenticate, _.noop).then(has => {\n          if (has) {\n            return;\n          }\n\n          event.preventDefault();\n          return Auth.isLoggedIn(_.noop).then(is => {\n            $state.go(is ? 'chatRoom' : 'main');\n          });\n        });\n      } else {\n        Auth.isLoggedIn(_.noop).then(is => {\n          if (is) {\n            return;\n          }\n\n          event.preventDefault();\n          $state.go('main');\n        });\n      }\n    });\n  });\n\n})();\n"]}